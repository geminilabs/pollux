pollux.dependency={},pollux.editors={},pollux.featured={},pollux.metabox={},pollux.tabs={},pollux.classListAction=function(a){return a?"add":"remove"},pollux.dependency.ajax=function(a,b,c){var d=pollux.dependency.getAjaxOptions(b);wp.ajax.send({error:d.error,success:d.success,data:{_ajax_nonce:wp.updates.ajaxNonce,action:a,plugin:d.plugin,type:c}})},pollux.dependency.getAjaxOptions=function(a){return{error:pollux.dependency.onError.bind(a),plugin:a.getAttribute("data-plugin"),slug:a.getAttribute("data-slug"),success:pollux.dependency.onSuccess.bind(a)}},pollux.dependency.init=function(){pollux.dependency.buttons=document.querySelectorAll(".pollux-notice a.button"),[].forEach.call(pollux.dependency.buttons,function(a){a.addEventListener("click",pollux.dependency.onClick)})},pollux.dependency.install=function(a,b){return pollux.dependency.updateButtonText(a,"pluginInstallingLabel"),a.classList.add("updating-message"),wp.updates.ajax("install-plugin",b)},pollux.dependency.onClick=function(a){var b=this.href.match(/action=([^&]+)/);null!==b&&(b=b[1].split("-")[0],!!pollux.dependency[b])&&(this.blur(),a.preventDefault(),this.classList.contains("updating-message")||pollux.dependency[b](this,pollux.dependency.getAjaxOptions(this)))},pollux.dependency.onError=function(){window.location=this.href},pollux.dependency.onSuccess=function(a){var b=this,c=a.install?"install":"update";return a.activate_url?void(pollux.dependency.setUpdatedMessage(b,c),a.activate_url&&setTimeout(function(){pollux.dependency.setActivateButton(b,a)},1e3)):pollux.dependency.ajax("pollux/dependency/activate_url",b,c)},pollux.dependency.setActivateButton=function(a,b){a.classList.remove("updated-message"),a.classList.remove("button-disabled"),a.classList.add("button-primary"),a.href=b.activate_url,pollux.dependency.updateButtonText(a,"activatePluginLabel")},pollux.dependency.setUpdatedMessage=function(a,b){a.classList.remove("updating-message"),a.classList.add("updated-message"),a.classList.add("button-disabled"),pollux.dependency.updateButtonText(a,"install"===b?"pluginInstalledLabel":"updatedLabel")},pollux.dependency.updateButtonText=function(a,b){if(wp.updates.l10n[b]){var c=wp.updates.l10n[b].replace("%s",a.getAttribute("data-name"));a.innerHTML!==c&&(a.innerHTML=c)}},pollux.dependency.upgrade=function(a,b){return pollux.dependency.updateButtonText(a,"updatingLabel"),a.classList.add("updating-message"),wp.updates.ajax("update-plugin",b)},pollux.editors.disable=function(a){pollux.editors.all[a].setOption("theme","disabled"),pollux.editors.all[a].setOption("readOnly","nocursor")},pollux.editors.enable=function(a){pollux.editors.all[a].setOption("theme","pollux"),pollux.editors.all[a].setOption("readOnly",!1)},pollux.editors.init=function(){pollux.editors.all=[],[].forEach.call(document.querySelectorAll(".pollux-code"),function(a,b){pollux.editors.all[b]=CodeMirror.fromTextArea(a,{gutters:["CodeMirror-lint-markers"],highlightSelectionMatches:{wordsOnly:!0},lineNumbers:!0,lint:!0,mode:"text/yaml",showInvisibles:!0,showTrailingSpace:!0,styleActiveLine:!0,tabSize:2,theme:"pollux",viewportMargin:1/0}),pollux.editors.all[b].setOption("extraKeys",{Tab:function(a){var b=Array(a.getOption("indentUnit")+1).join(" ");a.replaceSelection(b)}}),pollux.editors.all[b].display.wrapper.setAttribute("data-disabled",a.getAttribute("data-disabled")),a.readOnly&&pollux.editors.disable(b)})},pollux.featured.init=function(){jQuery("#postimagediv").on("click","#pollux-set-featured",function(a){a.preventDefault(),wp.media.view.settings.post.featuredImageId=Math.round(jQuery("#featured").val()),pollux.featured.frame=wp.media.featuredImage.frame,pollux.featured.frame().open()}).on("click","#pollux-remove-featured",function(a){a.preventDefault(),pollux.featured.set(-1)})},pollux.featured.select=function(){if(wp.media.view.settings.post.featuredImageId){var a=this.get("selection").single();pollux.featured.set(a?a.id:-1)}},pollux.featured.set=function(a){wp.media.view.settings.post.featuredImageId=Math.round(a),wp.media.post("pollux/archives/featured/html",{_wpnonce:document.querySelector("#_wpnonce").value,post_type:document.querySelector("#archive-type").value,thumbnail_id:a}).done(function(a){document.querySelector("#postimagediv > .inside").innerHTML=a})},pollux.metabox.hasValue=function(a){return"checkbox"===a.type?!0===a.checked:""!==a.value},pollux.metabox.init=function(){var a=document.querySelectorAll(".rwmb-input [data-depends]");[].forEach.call(a,function(a){var b=pollux.metabox.setVisibility(a),c=-1===["checkbox","radio","select-one","select-multiple"].indexOf(b.type)?"keyup":"change";b.addEventListener(c,function(){pollux.metabox.setVisibility(a)})})},pollux.metabox.setVisibility=function(a){var b=document.getElementById(a.getAttribute("data-depends")),c=pollux.classListAction(!pollux.metabox.hasValue(b));return a.closest(".rwmb-field").classList[c]("hidden"),b},pollux.tabs.init=function(){pollux.tabs.active=document.querySelector("#pollux-active-tab"),pollux.tabs.referrer=document.querySelector("input[name=\"_wp_http_referer\"]"),pollux.tabs.tabs=document.querySelectorAll(".pollux-tabs a"),pollux.tabs.views=document.querySelectorAll(".pollux-config .form-table"),[].forEach.call(pollux.tabs.tabs,function(a,b){var c=location.hash?a.getAttribute("href").slice(1)===location.hash.slice(2):0===b;c&&pollux.tabs.setTab(a),a.addEventListener("click",pollux.tabs.onClick),a.addEventListener("touchend",pollux.tabs.onClick)})},pollux.tabs.onClick=function(a){a.preventDefault(),this.blur(),pollux.tabs.setTab(this),location.hash="!"+this.getAttribute("href").slice(1)},pollux.tabs.setReferrer=function(a){var b=pollux.tabs.referrer.value.split("#")[0]+"#!"+pollux.tabs.views[a].id;pollux.tabs.referrer.value=b},pollux.tabs.setTab=function(a){[].forEach.call(pollux.tabs.tabs,function(b,c){var d=pollux.classListAction(b===a);"add"===d&&(pollux.tabs.active.value=pollux.tabs.views[c].id,pollux.tabs.setReferrer(c),pollux.tabs.setView(c)),b.classList[d]("nav-tab-active")})},pollux.tabs.setView=function(a){[].forEach.call(pollux.tabs.views,function(b,c){var d=pollux.classListAction(c!==a);b.classList[d]("ui-tabs-hide")})},jQuery(function(a){for(var b in pollux)pollux.hasOwnProperty(b)&&pollux[b].init&&pollux[b].init();a(".pollux-card.postbox").addClass("closed").find(".handlediv").attr("aria-expanded",!1),a(".pollux-card.postbox .pollux-card-header").on("click",function(){var b=a(this).parent(),c=b.hasClass("closed")?"remove":"add";b[c+"Class"]("closed").find(".handlediv").attr("aria-expanded","add"!==c)})});